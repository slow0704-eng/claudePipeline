# 한글 인코딩 문제 해결 가이드

## 문제 상황
기존에 등록된 사용자의 닉네임이 '�׽�Ʈ����'와 같이 깨져서 표시됨

## 해결 방법

### 1단계: 데이터베이스 인코딩 설정 변경

MySQL에 접속하여 다음 SQL을 실행하세요:

```bash
mysql -u root -p boarddb < fix_encoding.sql
```

또는 MySQL 클라이언트에서 직접:

```sql
-- 데이터베이스를 UTF-8로 변경
ALTER DATABASE boarddb CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;

-- users 테이블을 UTF-8로 변경
ALTER TABLE users CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 각 컬럼을 명시적으로 UTF-8로 변경
ALTER TABLE users
  MODIFY username VARCHAR(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci,
  MODIFY password VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci,
  MODIFY nickname VARCHAR(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci,
  MODIFY email VARCHAR(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci,
  MODIFY name VARCHAR(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 2단계: 기존 깨진 데이터 복구

#### 방법 1: SQL로 자동 복구 시도

```bash
mysql -u root -p boarddb < recover_korean_data.sql
```

이 방법은 Latin1으로 잘못 저장된 UTF-8 데이터를 자동으로 복구합니다.

#### 방법 2: 관리자 페이지에서 직접 수정 (권장)

1. Spring Boot 애플리케이션을 재시작
2. 관리자 계정으로 로그인
3. http://localhost:8080/admin/users 접속
4. 각 사용자 행의 "수정" 버튼 클릭
5. 올바른 닉네임과 이름을 입력
6. "저장" 버튼 클릭

**장점:**
- 시각적으로 확인하면서 수정 가능
- 실시간으로 결과 확인 가능
- 실수해도 쉽게 다시 수정 가능

#### 방법 3: SQL로 직접 수정

```sql
-- 특정 사용자의 정보 수정
UPDATE users SET nickname = '테스트유저', name = '테스트' WHERE id = 1;
UPDATE users SET nickname = '홍길동', name = '홍길동' WHERE id = 2;
-- 필요한 만큼 반복...
```

### 3단계: 애플리케이션 재시작

수정사항이 반영되도록 Spring Boot 애플리케이션을 재시작하세요.

```bash
# 현재 실행 중인 애플리케이션 종료 후
./mvnw spring-boot:run
# 또는
java -jar target/board-0.0.1-SNAPSHOT.jar
```

### 4단계: 결과 확인

1. http://localhost:8080/admin/users 에서 관리자 페이지 확인
2. http://localhost:8080/user/1 등 사용자 프로필 페이지 확인
3. 닉네임이 정상적으로 표시되는지 확인

## 수정된 파일 목록

1. **application.properties** - MySQL 연결 시 UTF-8 인코딩 설정 추가
2. **AdminController.java** - 사용자 정보 수정 API 추가 (`/admin/users/{userId}/update-info`)
3. **admin/users.html** - 사용자 정보 인라인 수정 UI 추가

## 향후 대책

이제 새로 입력되는 한글 데이터는 자동으로 올바르게 저장됩니다:

- MySQL 연결 문자열에 UTF-8 설정 추가
- Hibernate도 UTF-8로 설정
- 새로 가입하는 사용자는 문제없이 한글 저장

## 문제가 계속되는 경우

1. MySQL 서버의 기본 character set 확인:
   ```sql
   SHOW VARIABLES LIKE 'character%';
   SHOW VARIABLES LIKE 'collation%';
   ```

2. my.cnf 또는 my.ini 파일에 다음 설정 추가:
   ```ini
   [client]
   default-character-set=utf8mb4

   [mysql]
   default-character-set=utf8mb4

   [mysqld]
   character-set-server=utf8mb4
   collation-server=utf8mb4_unicode_ci
   ```

3. MySQL 재시작 후 다시 시도

## 추가 도움말

- 관리자 페이지 접속: http://localhost:8080/admin
- 사용자 관리 페이지: http://localhost:8080/admin/users
- 각 사용자 프로필: http://localhost:8080/user/{userId}
